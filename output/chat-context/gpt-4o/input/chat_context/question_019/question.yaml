 question: Where do we query the embeddings model?
# CHAT
# CHAT_QUESTION Where do we query the embeddings model?

# CHAT_REPLY Based on the provided codebase context, the embeddings model is queried in the `retrieveEmbeddingBasedContext` method within the `context-ranking.ts` file. Here is the relevant code snippet:
# CHAT_REPLY 
# CHAT_REPLY ```typescript
# CHAT_REPLY public async retrieveEmbeddingBasedContext(
# CHAT_REPLY     query: PromptString,
# CHAT_REPLY     numResults: number,
# CHAT_REPLY     modelName: string
# CHAT_REPLY ): Promise<EmbeddingsSearchResult[]> {
# CHAT_REPLY     const repoUri = this.getRepoUri()
# CHAT_REPLY     if (!repoUri || !this.endpointIsDotcom || !this.serviceStarted) {
# CHAT_REPLY         return []
# CHAT_REPLY     }
# CHAT_REPLY     try {
# CHAT_REPLY         const service = await this.getService()
# CHAT_REPLY         const resp = await service.request('context-ranking/context-retriever-embedding', {
# CHAT_REPLY             repoPath: repoUri.path,
# CHAT_REPLY             query: query.toString(),
# CHAT_REPLY             modelName: modelName,
# CHAT_REPLY             numResults: numResults,
# CHAT_REPLY         })
# CHAT_REPLY         const model_specific_embedding_items = resp.results.map(result => ({
# CHAT_REPLY             ...result,
# CHAT_REPLY             uri: vscode.Uri.joinPath(repoUri, result.fileName),
# CHAT_REPLY         }))
# CHAT_REPLY         return model_specific_embedding_items
# CHAT_REPLY     } catch (error) {
# CHAT_REPLY         logDebug(
# CHAT_REPLY             'ContextRankingController',
# CHAT_REPLY             'error in fetching embeddings features',
# CHAT_REPLY         )
# CHAT_REPLY         return []
# CHAT_REPLY     }
# CHAT_REPLY }
# CHAT_REPLY ```
# CHAT_REPLY 
# CHAT_REPLY In this method, the `service.request` function is called with the `'context-ranking/context-retriever-embedding'` endpoint, and it sends the `repoPath`, `query`, `modelName`, and `numResults` as parameters to query the embeddings model.

# CONTEXT_ITEMS [{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/lib/shared/src/models/index.tsL132-134"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/webviews/chat/models/chatModelContext.tsxL4-7"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/agent/src/cli/evaluate-autocomplete/Queries.tsL40-84"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/agent/src/cli/evaluate-autocomplete/Queries.tsL21-38"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/tree-sitter/query-sdk.test.tsL0-46"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/tree-sitter/query-sdk.tsL0-550"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/jsonrpc/embeddings-protocol.tsL0-125"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/local-context/context-ranking.tsL279-311"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/context/remote-search.tsL111-118"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/testutils/uri.tsL72-74"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/supercompletions/prompt.tsL2-2"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/package.jsonL502-541"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/local-context/local-embeddings.tsL103-127"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/agent/src/cli/scip-codegen/scip.tsL3000-3017"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/completions/providers/fireworks.tsL68-95"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/lib/shared/src/index.tsL0-26"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/pnpm-lock.yamlL7525-7552"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/package.jsonL962-993"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/chat/chat-view/SimpleChatPanelProvider.tsL36-59"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/local-context/local-embeddings.tsL30-58"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/lib/shared/src/models/types.tsL0-62"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/local-context/context-ranking.tsL226-254"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/local-context/context-ranking.tsL286-313"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/jsonrpc/context-ranking-protocol.tsL0-57"}]

 class: Find logic
