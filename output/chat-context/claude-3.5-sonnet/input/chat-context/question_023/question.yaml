 question: Where is the code that enforces the context length limit?
# CHAT
# CHAT_QUESTION Where is the code that enforces the context length limit?

# CHAT_REPLY The code that enforces the context length limit can be found in several places within the provided codebase context:
# CHAT_REPLY 
# CHAT_REPLY 1. In the `truncateTextNearestLine` function in the file `cody_test/lib/shared/src/prompt/truncation.ts`, which truncates text to a specified maximum number of bytes.
# CHAT_REPLY 
# CHAT_REPLY 2. In the `standardContextSizeHints` function in `cody_test/vscode/src/completions/providers/provider.ts`, which calculates character limits for different parts of the context based on a maximum token count.
# CHAT_REPLY 
# CHAT_REPLY 3. In the `limitMatches` function in `mocked/codebase_context/limit.go`, which limits the number of matches in file search results.
# CHAT_REPLY 
# CHAT_REPLY 4. In the `limitChunkMatches` and `limitLineMatches` functions in `mocked/codebase_context/limit.go`, which enforce limits on chunk and line matches respectively.
# CHAT_REPLY 
# CHAT_REPLY 5. In the `getContextFileFromUri` function in `cody_test/vscode/src/commands/context/file-path.ts`, which uses `TokenCounter.countTokens` to measure the size of file content.
# CHAT_REPLY 
# CHAT_REPLY 6. In the directory context retrieval code in `cody_test/vscode/src/commands/context/directory.ts`, which limits the number of files to 10 and skips files larger than 1MB.
# CHAT_REPLY 
# CHAT_REPLY These implementations work together to ensure that context lengths are kept within specified limits throughout the codebase.

# CONTEXT_ITEMS [{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/mocked/enhanced_context/limit.goL61-63"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/commands/context/directory.tsL49-74"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/mocked/enhanced_context/limit.goL132-134"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/agent/src/AgentTextDocument.tsL91-122"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/mocked/enhanced_context/limit.goL164-169"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/lib/shared/src/codebase-context/messages.tsL38-88"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/mocked/codebase_context/limit.goL129-143"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/lib/shared/src/token/constants.tsL0-40"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/mocked/codebase_context/limit.goL80-125"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/commands/context/file-path.tsL0-43"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/mocked/codebase_context/limit.goL62-76"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/commands/context/workspace.tsL22-51"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/mocked/enhanced_context/limit.goL20-36"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/completions/providers/fireworks.tsL175-199"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/mocked/enhanced_context/limit.goL85-99"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/edit/prompt/context.tsL39-61"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/completions/providers/provider.tsL27-57"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/services/utils/code-count.test.tsL0-57"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/lib/shared/src/prompt/truncation.tsL25-60"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/commands/services/code-lenses.tsL0-203"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/context/remote-search.tsL152-163"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/services/utils/code-count.tsL0-21"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/chat/chat-view/prompt.tsL57-80"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/test/e2e/code-actions.test.tsL0-73"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/chat/utils.tsL104-135"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/completions/context/retrievers/jaccard-similarity/jaccard-similarity-retriever.tsL0-22"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/mocked/enhanced_context/limit.goL138-138"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat-context/cody_test/vscode/src/completions/context/context-mixer.tsL0-33"}]

 class: Find logic
