 question: Where is the code for inserting autocompletions?
# CHAT
# CHAT_QUESTION Where is the code for inserting autocompletions?

# CHAT_REPLY The code for inserting autocompletions can be found in the file `cody_test/vscode/src/completions/inline-completion-item-provider.ts`. Specifically, the function `updateInsertRangeForVSCode` in the file `cody_test/vscode/src/completions/suggested-autocomplete-items-cache.ts` is responsible for updating the insertion range for VSCode.
# CHAT_REPLY 
# CHAT_REPLY Here is the relevant snippet from `inline-completion-item-provider.ts`:
# CHAT_REPLY 
# CHAT_REPLY ```typescript
# CHAT_REPLY import {
# CHAT_REPLY     type AutocompleteInlineAcceptedCommandArgs,
# CHAT_REPLY     type AutocompleteItem,
# CHAT_REPLY     analyticsItemToAutocompleteItem,
# CHAT_REPLY     suggestedAutocompleteItemsCache,
# CHAT_REPLY     updateInsertRangeForVSCode,
# CHAT_REPLY } from './suggested-autocomplete-items-cache'
# CHAT_REPLY ```
# CHAT_REPLY 
# CHAT_REPLY And the function `updateInsertRangeForVSCode` from `suggested-autocomplete-items-cache.ts`:
# CHAT_REPLY 
# CHAT_REPLY ```typescript
# CHAT_REPLY export function updateInsertRangeForVSCode(items: AutocompleteItem[]): AutocompleteItem[] {
# CHAT_REPLY     return items.map(item => {
# CHAT_REPLY         const {
# CHAT_REPLY             insertText,
# CHAT_REPLY             range,
# CHAT_REPLY             requestParams: { position, document },
# CHAT_REPLY         } = item
# CHAT_REPLY 
# CHAT_REPLY         const currentLine = document.lineAt(position)
# CHAT_REPLY         const currentLinePrefix = document.getText(currentLine.range.with({ end: position }))
# CHAT_REPLY 
# CHAT_REPLY         const start = currentLine.range.start
# CHAT_REPLY         // If the completion does not have a range set it will always exclude the same line suffix,
# CHAT_REPLY         // so it has to overwrite the current same line suffix and reach to the end of the line.
# CHAT_REPLY         const end = range?.end || currentLine.range.end
# CHAT_REPLY 
# CHAT_REPLY         const vscodeInsertRange = new vscode.Range(start, end)
# CHAT_REPLY 
# CHAT_REPLY         item.range = vscodeInsertRange
# CHAT_REPLY         item.insertText = currentLinePrefix + (insertText as string)
# CHAT_REPLY 
# CHAT_REPLY         return item
# CHAT_REPLY     })
# CHAT_REPLY }
# CHAT_REPLY ```
# CHAT_REPLY 
# CHAT_REPLY This function is responsible for adjusting the insertion range and text for the autocompletion items before they are inserted into the document.

# CONTEXT_ITEMS [{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/agent/src/cli/evaluate-autocomplete/evaluate-autocomplete.tsL120-278"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/agent/src/cli/evaluate-autocomplete/AutocompleteMatcher.tsL14-20"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/agent/src/cli/evaluate-autocomplete/triggerAutocomplete.tsL17-31"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/agent/src/cli/evaluate-autocomplete/triggerAutocomplete.tsL33-162"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/agent/src/cli/evaluate-autocomplete/AutocompleteMatcher.tsL21-172"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/src/code-actions/CodeActionProvider.tsL25-38"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/src/services/utils/code-count.test.tsL0-57"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/src/services/utils/code-count.tsL0-21"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/src/commands/services/code-lenses.tsL0-203"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/test/e2e/code-actions.test.tsL0-73"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/src/services/utils/codeblock-action-tracker.tsL77-94"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/agent/src/cli/scip-codegen/scip.tsL2010-2012"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/src/completions/suggested-autocomplete-items-cache.tsL171-194"},{"source":"search","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/CHANGELOG.mdL998-1015"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/TESTING.mdL345-367"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/src/completions/tracer/traceView.tsL0-24"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/lib/shared/src/configuration.tsL33-66"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/TESTING.mdL0-32"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/src/jsonrpc/agent-protocol.tsL342-378"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/src/completions/logger.tsL62-92"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/src/completions/providers/unstable-openai.tsL0-36"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/src/completions/providers/anthropic.tsL0-45"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/src/completions/inline-completion-item-provider.tsL47-82"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/src/configuration.tsL95-112"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/src/completions/request-manager.tsL0-28"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/package.jsonL1033-1050"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/walkthroughs/autocomplete.mdL0-11"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/vscode/src/completions/inline-completion-item-provider.tsL24-47"},{"source":"embeddings","file":"/Users/jan/repos/cody-leaderboard/input/chat_context/cody_test/lib/shared/src/configuration.tsL66-98"}]

 class: Find logic
